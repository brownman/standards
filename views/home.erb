<% if @tasks.count == 0 %>
	<div class="hero-unit">
		<h2>This is your home.</h2>
		<p>Follow <a href="http://twitter.com/standardsapp">@standardsapp</a> on Twitter, and opt-in for email updates in the settings.</p>
		<p>Add a task to get started.</p>
	</div>
	<div id="check-table">
		<table>
			<thead>
				<tr>
					<th></th>
					<% todayAsDate = Time.zone.now.to_date %>
					<% first_day = todayAsDate - todayAsDate.wday %>
					<% if @user.starting_weekday > todayAsDate.wday %>
						<% first_day = first_day - (7 - @user.starting_weekday) %>
					<% elsif @user.starting_weekday == todayAsDate.wday %>
						<% first_day = first_day + @user.starting_weekday + 1 %>
					<% else %>
						<% first_day = first_day + @user.starting_weekday + 1 %>
					<% end %>
					<% date_range = (first_day..(first_day + 6)).to_a %>
					<% date_range.each do |day| %>
						<% if todayAsDate.wday == @user.starting_weekday %>
							<% day = day - 1 # show yesterday if we're at the start of the week %>
						<% end %>
						<th class="
							<%= ' hidden-phone' if day < todayAsDate - 1 || day > todayAsDate %>
							<%= ' today' if todayAsDate == day %>">
							<%= day.strftime('%A') %></th>
					<% end %>
				</tr>
			</thead>
			<tfoot>
				<tr>
					<td class="title add" style="height: 50px;" colspan="8">
						<div class="ministat"></div>
						<a class="add" style="border-color: #CCC"><i class="icon-plus-sign"></i></a>
						<form id="newtask" class="form">
							<input id="title" name="title" type="text" autocapitalize="sentence" autocorrect="true" placeholder="Task: Go for a bike ride"></input>
							<input id="purpose" name="purpose" type="text" autocapitalize="sentence" autocorrect="true" placeholder="Purpose: I want to be healthier"></input>
							<button type="submit" class="btn">Add it!</button>
						</form>
					</td>
				</tr>
			</tfoot>
			<tbody>
				<% @tasks.each_with_index do |task, i| %>
					<% @task = task %>
					<% @rowNum = i %>
					<%= erb :task_row, :layout => false %>
				<% end %>
			</tbody>
		</table>
	</div><!-- / -->
<% else %>
	<div id="check-table">
		<table>
			<thead>
				<tr>
					<th></th>
					<% todayAsDate = Time.zone.now.to_date %>
					<% first_day = todayAsDate - todayAsDate.wday %>
					<%# show yesterday if we're at the start of the week %>
					<% if todayAsDate.wday == @user.starting_weekday %>
						<% first_day = first_day - 1 %>
					<% end %>
					<%# if the starting weekday is ahead of the current weekday, start in the previous week %>
					<% if @user.starting_weekday > todayAsDate.wday %>
						<% first_day = first_day - (7 - @user.starting_weekday) %>
					<%# otherwise just start in the current week during the defined weekday %>
					<% else %>
						<% first_day = first_day + @user.starting_weekday %>
					<% end %>
					<%# build the table headers %>
					<% date_range = (first_day..(first_day + 6)).to_a %>
					<% date_range.each do |day| %>
						<th class="
							<%= ' hidden-phone' if day < todayAsDate - 1 || day > todayAsDate %>
							<%= ' today' if todayAsDate == day %>">
							<%= day.strftime('%A') %></th>
					<% end %>
				</tr>
			</thead>
			<tfoot>
				<tr>
					<td class="title add" style="height: 50px;" colspan="8">
						<div class="ministat"></div>
						<a class="add" style="border-color: #CCC"><i class="icon-plus-sign"></i></a>
						<form id="newtask" class="form">
							<input id="title" name="title" type="text" autocapitalize="sentence" autocorrect="true" placeholder="Task: Go for a bike ride"></input>
							<input id="purpose" name="purpose" type="text" autocapitalize="sentence" autocorrect="true" placeholder="Purpose: I want to be healthier"></input>
							<button type="submit" class="btn">Add it!</button>
						</form>
					</td>
				</tr>
			</tfoot>
			<tbody>
				<% @tasks.each_with_index do |task, i| %>
					<% @task = task %>
					<% @rowNum = i %>
					<%= erb :task_row, :layout => false %>
				<% end %>
			</tbody>
		</table>
	</div><!-- / -->
<% end %>