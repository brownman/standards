$(document).ready(function(){function c(a,b){colors=[];var c,d,b,e;for(var f=0;f<a;f++){c=f*340/(a+2);d=.8;e=1;var g=$.Color({hue:c,saturation:d,lightness:b,alpha:e}).toHslaString();colors.push($.Color(g).toHexString())}return colors}$(document).on("click","a[href]:not(.delete, .delete-confirm, .target, .title)",function(a){a.preventDefault();window.location=$(this).attr("href")});$(document).on("tap","a[href]:not(.delete, .delete-confirm, .target, .title)",function(a){a.preventDefault();window.location=$(this).attr("href")});if("ontouchend"in window){$(document).delegate("body","click",function(a){$(a.target).trigger("tap")})}var a=$(".navbar");$(window).scroll(function(b){if(a.offset().top!==0){if(!a.hasClass("nav-drop-shadow")){a.addClass("nav-drop-shadow")}}else{a.removeClass("nav-drop-shadow")}});var b=$("select#timezone");if(b.data("zone")!==null){b.val(b.data("zone"))}$("input#name").keyup(function(){if($(this).val().length>1){if(!$(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}else{if($(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}});$("input#email").keyup(function(){var a=/(.+)@(.+){2,}\.(.+){2,}/;if(a.test($(this).val())){if(!$(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}else{if($(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}});$("input#password").keyup(function(){if($(this).val().length>=8){if(!$(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}else{if($(this).parents(".control-group").hasClass("success")){$(this).parents(".control-group").toggleClass("success")}}});jQuery.fn.reset=function(){$(this).each(function(){this.reset()})};$("a.add").click(function(a){if(!$(this).children("i").hasClass("cancel")){$("input#title").focus();$(this).children("i").animate({transform:"rotate(45deg)"},"fast").toggleClass("cancel");$(this).css("color","red");$(this).siblings("#newtask").animate({opacity:1},"fast").css("visibility","visible")}else{$(this).children("i").animate({transform:""},"fast").toggleClass("cancel");$(this).css("color","#CCC");$(this).siblings("#newtask").animate({opacity:0},"fast",function(){$(this).css("visibility","hidden");$(this).reset()})}});$("#newtask > input#purpose").keypress(function(a){if(a.which===13){a.preventDefault();$("#newtask").submit()}});var d=function(){var a=$("tbody").children();bgColors=c(a.size(),.8);barColors=c(a.size(),.6);$(a).each(function(a){var b=$(this).children("td.title").children(".ministat");b.css("background-color",bgColors[a]);b.children(".minibar").css("background-color",colors[a])})};d();var e=function(){var a=$("tbody").children();$(a).each(function(a){var b=$(this).children("td.title").children(".ministat").children(".minibar");var c=b.data();var d=c.count;var e=c.total;b.css("height",50*d/e)})};e();var f=function(a){var b=$(a).parents("tr").children("td.title").children(".ministat").children(".minibar");var c=b.data();c.count+=1;e()};var g=function(a){var b=$(a).parents("tr").children("td.title").children(".ministat").children(".minibar");var c=b.data();c.count-=1;e()};$("#newtask").submit(function(a){a.preventDefault();$.post("/new",$(this).serialize(),function(a){$("tbody").append(a);updateColors();$("a.add").children("i").animate({transform:""},"fast").toggleClass("cancel");$("a.add").css("color","#CCC").siblings("#newtask").animate({opacity:0},"fast",function(){$(this).reset()})},"text")});$(document).on("click","a.delete",function(a){$(this).siblings(".deleteModal").modal()});$(document).on("click","a.delete-confirm",function(a){var b=this;a.preventDefault();$.post(b.href,{_method:"delete"},function(a){$(this).parents(".deleteModal").modal("hide");window.location.pathname="/"},"script")});$(document).on("click",".delete-confirm",function(){$(".delete-confirm").button("loading")});$(document).on("click","a.target",function(a){var b=this;a.preventDefault();$(b).children("img").toggleClass("complete");if($(b).children("img").hasClass("complete")){f(b)}else{g(b)}$.post(b.href,null,function(a){if(a!==""){$(b).children("img").toggleClass("complete");if($(b).children("img").hasClass("complete")){f(b)}else{g(b)}}}).error(function(){$(b).children("img").toggleClass("complete")})});$("button.forgot").click(function(a){a.preventDefault();$(this).parents("form").attr("action","/forgot");$(this).parents("form").submit()});var h=false;$(document).on("keypress","p > span.title",function(a){if(a.which===13){a.preventDefault();if(h){$(this).trigger("editableSubmit");h=false}}});$(document).on("click","a.rename",function(a){if(h){$(this).parent().siblings("td").children("p > span.title").trigger("editableSubmit");h=false}else{$(this).parent().siblings("td").children("p > span.title").trigger("blur");h=true}});var i=function(a){$(a).editable({editBy:"blur",submitBy:"editableSubmit",onSubmit:function(a){if(a.current!==a.previous){$.post($(this).closest("p > span.title").attr("href"),{title:a.current},function(b){if(b!=="true"){$("body > .container").prepend(b).alert();$(this).text(a.previous)}})}}})};i($("p > span.title"));var j=jstz.determine_timezone();var k=j.name();$("input#timezone").val(k)});(function(a){a.fn.editable=function(b){var c={onEdit:null,onSubmit:null,onCancel:null,editClass:null,submit:null,cancel:null,type:"text",submitBy:"blur",editBy:"click",options:null};if(b=="disable")return this.unbind(this.data("editable.options").editBy,this.data("editable.options").toEditable);if(b=="enable")return this.bind(this.data("editable.options").editBy,this.data("editable.options").toEditable);if(b=="destroy")return this.unbind(this.data("editable.options").editBy,this.data("editable.options").toEditable).data("editable.previous",null).data("editable.current",null).data("editable.options",null);var b=a.extend(c,b);b.toEditable=function(){$this=a(this);$this.data("editable.current",$this.html());opts=$this.data("editable.options");a.editableFactory[opts.type].toEditable($this.empty(),opts);$this.data("editable.previous",$this.data("editable.current")).children().focus().addClass(opts.editClass);if(opts.submit){a("<button/>").appendTo($this).html(opts.submit).one("mouseup",function(){opts.toNonEditable(a(this).parent(),true)})}else $this.one(opts.submitBy,function(){opts.toNonEditable(a(this),true)}).children().one(opts.submitBy,function(){opts.toNonEditable(a(this).parent(),true)});if(opts.cancel)a("<button/>").appendTo($this).html(opts.cancel).one("mouseup",function(){opts.toNonEditable(a(this).parent(),false)});if(a.isFunction(opts.onEdit))opts.onEdit.apply($this,[{current:$this.data("editable.current"),previous:$this.data("editable.previous")}])};b.toNonEditable=function(b,c){opts=b.data("editable.options");b.one(opts.editBy,opts.toEditable).data("editable.current",c?a.editableFactory[opts.type].getValue(b,opts):b.data("editable.current")).html(opts.type=="password"?"*****":b.data("editable.current"));var d=null;if(a.isFunction(opts.onSubmit)&&c==true)d=opts.onSubmit;else if(a.isFunction(opts.onCancel)&&c==false)d=opts.onCancel;if(d!=null)d.apply(b,[{current:b.data("editable.current"),previous:b.data("editable.previous")}])};this.data("editable.options",b);return this.one(b.editBy,b.toEditable)};a.editableFactory={text:{toEditable:function(b,c){a("<input/>").appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){return a.children().val()}},password:{toEditable:function(b,c){b.data("editable.current",b.data("editable.password"));b.data("editable.previous",b.data("editable.password"));a('<input type="password"/>').appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){a.data("editable.password",a.children().val());return a.children().val()}},textarea:{toEditable:function(b,c){a("<textarea/>").appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){return a.children().val()}},select:{toEditable:function(b,c){$select=a("<select/>").appendTo(b);a.each(c.options,function(b,c){a("<option/>").appendTo($select).html(c).attr("value",b)});$select.children().each(function(){var c=a(this);if(c.text()==b.data("editable.current"))return c.attr("selected","selected").text()})},getValue:function(b,c){var d=null;a("select",b).children().each(function(){if(a(this).attr("selected"))return d=a(this).text()});return d}}}})(jQuery);var jstz=function(){"use strict";var a="s",b=function(a){var b=-a.getTimezoneOffset();return b!==null?b:0},c=function(){return b(new Date(2010,0,1,0,0,0,0))},d=function(){return b(new Date(2010,5,1,0,0,0,0))},e=function(a){var e=a.getMonth()>5?d():c(),f=b(a);return e-f!==0},f=function(){var b=c(),e=d(),f=c()-d();if(f<0){return b+",1"}else if(f>0){return e+",1,"+a}return b+",0"},g=function(){var a=f();return new jstz.TimeZone(jstz.olson.timezones[a])};return{determine_timezone:g,date_is_dst:e}}();jstz.TimeZone=function(){"use strict";var a=null,b=null,c=null,d=function(){return a},e=function(){return b},f=function(){return c},g=function(){var b=jstz.olson.ambiguity_list[a],c=b.length,d=0,e=b[0];for(;d<c;d+=1){e=b[d];if(jstz.date_is_dst(jstz.olson.dst_start_dates[e])){a=e;return}}},h=function(){return typeof jstz.olson.ambiguity_list[a]!=="undefined"},i=function(d){c=d[0];a=d[1];b=d[2];if(h()){g()}};i.prototype={constructor:jstz.TimeZone,name:d,dst:e,offset:f};return i}();jstz.olson={};jstz.olson.timezones=function(){"use strict";return{"-720,0":["-12:00","Etc/GMT+12",false],"-660,0":["-11:00","Pacific/Pago_Pago",false],"-600,1":["-11:00","America/Adak",true],"-600,0":["-10:00","Pacific/Honolulu",false],"-570,0":["-09:30","Pacific/Marquesas",false],"-540,0":["-09:00","Pacific/Gambier",false],"-540,1":["-09:00","America/Anchorage",true],"-480,1":["-08:00","America/Los_Angeles",true],"-480,0":["-08:00","Pacific/Pitcairn",false],"-420,0":["-07:00","America/Phoenix",false],"-420,1":["-07:00","America/Denver",true],"-360,0":["-06:00","America/Guatemala",false],"-360,1":["-06:00","America/Chicago",true],"-360,1,s":["-06:00","Pacific/Easter",true],"-300,0":["-05:00","America/Bogota",false],"-300,1":["-05:00","America/New_York",true],"-270,0":["-04:30","America/Caracas",false],"-240,1":["-04:00","America/Halifax",true],"-240,0":["-04:00","America/Santo_Domingo",false],"-240,1,s":["-04:00","America/Asuncion",true],"-210,1":["-03:30","America/St_Johns",true],"-180,1":["-03:00","America/Godthab",true],"-180,0":["-03:00","America/Argentina/Buenos_Aires",false],"-180,1,s":["-03:00","America/Montevideo",true],"-120,0":["-02:00","America/Noronha",false],"-120,1":["-02:00","Etc/GMT+2",true],"-60,1":["-01:00","Atlantic/Azores",true],"-60,0":["-01:00","Atlantic/Cape_Verde",false],"0,0":["00:00","Etc/UTC",false],"0,1":["00:00","Europe/London",true],"60,1":["+01:00","Europe/Berlin",true],"60,0":["+01:00","Africa/Lagos",false],"60,1,s":["+01:00","Africa/Windhoek",true],"120,1":["+02:00","Asia/Beirut",true],"120,0":["+02:00","Africa/Johannesburg",false],"180,1":["+03:00","Europe/Moscow",true],"180,0":["+03:00","Asia/Baghdad",false],"210,1":["+03:30","Asia/Tehran",true],"240,0":["+04:00","Asia/Dubai",false],"240,1":["+04:00","Asia/Yerevan",true],"270,0":["+04:30","Asia/Kabul",false],"300,1":["+05:00","Asia/Yekaterinburg",true],"300,0":["+05:00","Asia/Karachi",false],"330,0":["+05:30","Asia/Kolkata",false],"345,0":["+05:45","Asia/Kathmandu",false],"360,0":["+06:00","Asia/Dhaka",false],"360,1":["+06:00","Asia/Omsk",true],"390,0":["+06:30","Asia/Rangoon",false],"420,1":["+07:00","Asia/Krasnoyarsk",true],"420,0":["+07:00","Asia/Jakarta",false],"480,0":["+08:00","Asia/Shanghai",false],"480,1":["+08:00","Asia/Irkutsk",true],"525,0":["+08:45","Australia/Eucla",true],"525,1,s":["+08:45","Australia/Eucla",true],"540,1":["+09:00","Asia/Yakutsk",true],"540,0":["+09:00","Asia/Tokyo",false],"570,0":["+09:30","Australia/Darwin",false],"570,1,s":["+09:30","Australia/Adelaide",true],"600,0":["+10:00","Australia/Brisbane",false],"600,1":["+10:00","Asia/Vladivostok",true],"600,1,s":["+10:00","Australia/Sydney",true],"630,1,s":["+10:30","Australia/Lord_Howe",true],"660,1":["+11:00","Asia/Kamchatka",true],"660,0":["+11:00","Pacific/Noumea",false],"690,0":["+11:30","Pacific/Norfolk",false],"720,1,s":["+12:00","Pacific/Auckland",true],"720,0":["+12:00","Pacific/Tarawa",false],"765,1,s":["+12:45","Pacific/Chatham",true],"780,0":["+13:00","Pacific/Tongatapu",false],"780,1,s":["+13:00","Pacific/Apia",true],"840,0":["+14:00","Pacific/Kiritimati",false]}}();jstz.olson.dst_start_dates=function(){"use strict";return{"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"Atlantic/Stanley":new Date(2011,8,4,7,0,0,0),"America/Asuncion":new Date(2011,9,2,3,0,0,0),"America/Santiago":new Date(2011,9,9,3,0,0,0),"America/Campo_Grande":new Date(2011,9,16,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2011,2,13,2,0,0,0),"America/New_York":new Date(2011,2,13,7,0,0,0),"Asia/Gaza":new Date(2011,2,26,23,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Minsk":new Date(2011,2,27,2,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Africa/Cairo":new Date(2010,3,30,4,0,0,0),"Asia/Yerevan":new Date(2011,2,27,4,0,0,0),"Asia/Baku":new Date(2011,2,27,8,0,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,11,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0)}}();jstz.olson.ambiguity_list={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Asuncion":["Atlantic/Stanley","America/Asuncion","America/Santiago","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Gaza","Asia/Beirut","Europe/Minsk","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Africa/Cairo"],"Asia/Yerevan":["Asia/Yerevan","Asia/Baku"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"]};